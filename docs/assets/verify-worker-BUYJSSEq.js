(function(){"use strict";function Xr(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function Hr(x){if(x.__esModule)return x;var o=x.default;if(typeof o=="function"){var a=function w(){return this instanceof w?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};a.prototype=o.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(x).forEach(function(w){var j=Object.getOwnPropertyDescriptor(x,w);Object.defineProperty(a,w,j.get?j:{enumerable:!0,get:function(){return x[w]}})}),a}function Jr(x){throw new Error('Could not dynamically require "'+x+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ur={exports:{}},Qr={},kr=Object.freeze({__proto__:null,default:Qr}),ft=Hr(kr);(function(x){(function(o){var a=function(r){var e,t=new Float64Array(16);if(r)for(e=0;e<r.length;e++)t[e]=r[e];return t},w=function(){throw new Error("no PRNG")},j=new Uint8Array(16),Z=new Uint8Array(32);Z[0]=9;var J=a(),ef=a([1]),sf=a([56129,1]),Cf=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),or=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),zf=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Wf=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),ir=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function $f(r,e,t,f){r[e]=t>>24&255,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t&255,r[e+4]=f>>24&255,r[e+5]=f>>16&255,r[e+6]=f>>8&255,r[e+7]=f&255}function ar(r,e,t,f,n){var s,c=0;for(s=0;s<n;s++)c|=r[e+s]^t[f+s];return(1&c-1>>>8)-1}function Tr(r,e,t,f){return ar(r,e,t,f,16)}function xr(r,e,t,f){return ar(r,e,t,f,32)}function _t(r,e,t,f){for(var n=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,s=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,c=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,b=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,y=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,B=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,p=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,q=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,A=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,Y=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,P=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,O=t[16]&255|(t[17]&255)<<8|(t[18]&255)<<16|(t[19]&255)<<24,L=t[20]&255|(t[21]&255)<<8|(t[22]&255)<<16|(t[23]&255)<<24,F=t[24]&255|(t[25]&255)<<8|(t[26]&255)<<16|(t[27]&255)<<24,V=t[28]&255|(t[29]&255)<<8|(t[30]&255)<<16|(t[31]&255)<<24,R=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,S=n,m=s,E=c,U=b,I=y,v=B,u=p,_=q,h=A,l=Y,d=P,g=O,T=L,D=F,z=V,C=R,i,$=0;$<20;$+=2)i=S+T|0,I^=i<<7|i>>>25,i=I+S|0,h^=i<<9|i>>>23,i=h+I|0,T^=i<<13|i>>>19,i=T+h|0,S^=i<<18|i>>>14,i=v+m|0,l^=i<<7|i>>>25,i=l+v|0,D^=i<<9|i>>>23,i=D+l|0,m^=i<<13|i>>>19,i=m+D|0,v^=i<<18|i>>>14,i=d+u|0,z^=i<<7|i>>>25,i=z+d|0,E^=i<<9|i>>>23,i=E+z|0,u^=i<<13|i>>>19,i=u+E|0,d^=i<<18|i>>>14,i=C+g|0,U^=i<<7|i>>>25,i=U+C|0,_^=i<<9|i>>>23,i=_+U|0,g^=i<<13|i>>>19,i=g+_|0,C^=i<<18|i>>>14,i=S+U|0,m^=i<<7|i>>>25,i=m+S|0,E^=i<<9|i>>>23,i=E+m|0,U^=i<<13|i>>>19,i=U+E|0,S^=i<<18|i>>>14,i=v+I|0,u^=i<<7|i>>>25,i=u+v|0,_^=i<<9|i>>>23,i=_+u|0,I^=i<<13|i>>>19,i=I+_|0,v^=i<<18|i>>>14,i=d+l|0,g^=i<<7|i>>>25,i=g+d|0,h^=i<<9|i>>>23,i=h+g|0,l^=i<<13|i>>>19,i=l+h|0,d^=i<<18|i>>>14,i=C+z|0,T^=i<<7|i>>>25,i=T+C|0,D^=i<<9|i>>>23,i=D+T|0,z^=i<<13|i>>>19,i=z+D|0,C^=i<<18|i>>>14;S=S+n|0,m=m+s|0,E=E+c|0,U=U+b|0,I=I+y|0,v=v+B|0,u=u+p|0,_=_+q|0,h=h+A|0,l=l+Y|0,d=d+P|0,g=g+O|0,T=T+L|0,D=D+F|0,z=z+V|0,C=C+R|0,r[0]=S>>>0&255,r[1]=S>>>8&255,r[2]=S>>>16&255,r[3]=S>>>24&255,r[4]=m>>>0&255,r[5]=m>>>8&255,r[6]=m>>>16&255,r[7]=m>>>24&255,r[8]=E>>>0&255,r[9]=E>>>8&255,r[10]=E>>>16&255,r[11]=E>>>24&255,r[12]=U>>>0&255,r[13]=U>>>8&255,r[14]=U>>>16&255,r[15]=U>>>24&255,r[16]=I>>>0&255,r[17]=I>>>8&255,r[18]=I>>>16&255,r[19]=I>>>24&255,r[20]=v>>>0&255,r[21]=v>>>8&255,r[22]=v>>>16&255,r[23]=v>>>24&255,r[24]=u>>>0&255,r[25]=u>>>8&255,r[26]=u>>>16&255,r[27]=u>>>24&255,r[28]=_>>>0&255,r[29]=_>>>8&255,r[30]=_>>>16&255,r[31]=_>>>24&255,r[32]=h>>>0&255,r[33]=h>>>8&255,r[34]=h>>>16&255,r[35]=h>>>24&255,r[36]=l>>>0&255,r[37]=l>>>8&255,r[38]=l>>>16&255,r[39]=l>>>24&255,r[40]=d>>>0&255,r[41]=d>>>8&255,r[42]=d>>>16&255,r[43]=d>>>24&255,r[44]=g>>>0&255,r[45]=g>>>8&255,r[46]=g>>>16&255,r[47]=g>>>24&255,r[48]=T>>>0&255,r[49]=T>>>8&255,r[50]=T>>>16&255,r[51]=T>>>24&255,r[52]=D>>>0&255,r[53]=D>>>8&255,r[54]=D>>>16&255,r[55]=D>>>24&255,r[56]=z>>>0&255,r[57]=z>>>8&255,r[58]=z>>>16&255,r[59]=z>>>24&255,r[60]=C>>>0&255,r[61]=C>>>8&255,r[62]=C>>>16&255,r[63]=C>>>24&255}function lt(r,e,t,f){for(var n=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,s=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,c=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,b=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,y=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,B=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,p=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,q=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,A=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,Y=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,P=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,O=t[16]&255|(t[17]&255)<<8|(t[18]&255)<<16|(t[19]&255)<<24,L=t[20]&255|(t[21]&255)<<8|(t[22]&255)<<16|(t[23]&255)<<24,F=t[24]&255|(t[25]&255)<<8|(t[26]&255)<<16|(t[27]&255)<<24,V=t[28]&255|(t[29]&255)<<8|(t[30]&255)<<16|(t[31]&255)<<24,R=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,S=n,m=s,E=c,U=b,I=y,v=B,u=p,_=q,h=A,l=Y,d=P,g=O,T=L,D=F,z=V,C=R,i,$=0;$<20;$+=2)i=S+T|0,I^=i<<7|i>>>25,i=I+S|0,h^=i<<9|i>>>23,i=h+I|0,T^=i<<13|i>>>19,i=T+h|0,S^=i<<18|i>>>14,i=v+m|0,l^=i<<7|i>>>25,i=l+v|0,D^=i<<9|i>>>23,i=D+l|0,m^=i<<13|i>>>19,i=m+D|0,v^=i<<18|i>>>14,i=d+u|0,z^=i<<7|i>>>25,i=z+d|0,E^=i<<9|i>>>23,i=E+z|0,u^=i<<13|i>>>19,i=u+E|0,d^=i<<18|i>>>14,i=C+g|0,U^=i<<7|i>>>25,i=U+C|0,_^=i<<9|i>>>23,i=_+U|0,g^=i<<13|i>>>19,i=g+_|0,C^=i<<18|i>>>14,i=S+U|0,m^=i<<7|i>>>25,i=m+S|0,E^=i<<9|i>>>23,i=E+m|0,U^=i<<13|i>>>19,i=U+E|0,S^=i<<18|i>>>14,i=v+I|0,u^=i<<7|i>>>25,i=u+v|0,_^=i<<9|i>>>23,i=_+u|0,I^=i<<13|i>>>19,i=I+_|0,v^=i<<18|i>>>14,i=d+l|0,g^=i<<7|i>>>25,i=g+d|0,h^=i<<9|i>>>23,i=h+g|0,l^=i<<13|i>>>19,i=l+h|0,d^=i<<18|i>>>14,i=C+z|0,T^=i<<7|i>>>25,i=T+C|0,D^=i<<9|i>>>23,i=D+T|0,z^=i<<13|i>>>19,i=z+D|0,C^=i<<18|i>>>14;r[0]=S>>>0&255,r[1]=S>>>8&255,r[2]=S>>>16&255,r[3]=S>>>24&255,r[4]=v>>>0&255,r[5]=v>>>8&255,r[6]=v>>>16&255,r[7]=v>>>24&255,r[8]=d>>>0&255,r[9]=d>>>8&255,r[10]=d>>>16&255,r[11]=d>>>24&255,r[12]=C>>>0&255,r[13]=C>>>8&255,r[14]=C>>>16&255,r[15]=C>>>24&255,r[16]=u>>>0&255,r[17]=u>>>8&255,r[18]=u>>>16&255,r[19]=u>>>24&255,r[20]=_>>>0&255,r[21]=_>>>8&255,r[22]=_>>>16&255,r[23]=_>>>24&255,r[24]=h>>>0&255,r[25]=h>>>8&255,r[26]=h>>>16&255,r[27]=h>>>24&255,r[28]=l>>>0&255,r[29]=l>>>8&255,r[30]=l>>>16&255,r[31]=l>>>24&255}function Gf(r,e,t,f){_t(r,e,t,f)}function Nf(r,e,t,f){lt(r,e,t,f)}var pf=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Yr(r,e,t,f,n,s,c){var b=new Uint8Array(16),y=new Uint8Array(64),B,p;for(p=0;p<16;p++)b[p]=0;for(p=0;p<8;p++)b[p]=s[p];for(;n>=64;){for(Gf(y,b,c,pf),p=0;p<64;p++)r[e+p]=t[f+p]^y[p];for(B=1,p=8;p<16;p++)B=B+(b[p]&255)|0,b[p]=B&255,B>>>=8;n-=64,e+=64,f+=64}if(n>0)for(Gf(y,b,c,pf),p=0;p<n;p++)r[e+p]=t[f+p]^y[p];return 0}function Pr(r,e,t,f,n){var s=new Uint8Array(16),c=new Uint8Array(64),b,y;for(y=0;y<16;y++)s[y]=0;for(y=0;y<8;y++)s[y]=f[y];for(;t>=64;){for(Gf(c,s,n,pf),y=0;y<64;y++)r[e+y]=c[y];for(b=1,y=8;y<16;y++)b=b+(s[y]&255)|0,s[y]=b&255,b>>>=8;t-=64,e+=64}if(t>0)for(Gf(c,s,n,pf),y=0;y<t;y++)r[e+y]=c[y];return 0}function Fr(r,e,t,f,n){var s=new Uint8Array(32);Nf(s,f,n,pf);for(var c=new Uint8Array(8),b=0;b<8;b++)c[b]=f[b+16];return Pr(r,e,t,c,s)}function sr(r,e,t,f,n,s,c){var b=new Uint8Array(32);Nf(b,s,c,pf);for(var y=new Uint8Array(8),B=0;B<8;B++)y[B]=s[B+16];return Yr(r,e,t,f,n,y,b)}var Kf=function(r){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var e,t,f,n,s,c,b,y;e=r[0]&255|(r[1]&255)<<8,this.r[0]=e&8191,t=r[2]&255|(r[3]&255)<<8,this.r[1]=(e>>>13|t<<3)&8191,f=r[4]&255|(r[5]&255)<<8,this.r[2]=(t>>>10|f<<6)&7939,n=r[6]&255|(r[7]&255)<<8,this.r[3]=(f>>>7|n<<9)&8191,s=r[8]&255|(r[9]&255)<<8,this.r[4]=(n>>>4|s<<12)&255,this.r[5]=s>>>1&8190,c=r[10]&255|(r[11]&255)<<8,this.r[6]=(s>>>14|c<<2)&8191,b=r[12]&255|(r[13]&255)<<8,this.r[7]=(c>>>11|b<<5)&8065,y=r[14]&255|(r[15]&255)<<8,this.r[8]=(b>>>8|y<<8)&8191,this.r[9]=y>>>5&127,this.pad[0]=r[16]&255|(r[17]&255)<<8,this.pad[1]=r[18]&255|(r[19]&255)<<8,this.pad[2]=r[20]&255|(r[21]&255)<<8,this.pad[3]=r[22]&255|(r[23]&255)<<8,this.pad[4]=r[24]&255|(r[25]&255)<<8,this.pad[5]=r[26]&255|(r[27]&255)<<8,this.pad[6]=r[28]&255|(r[29]&255)<<8,this.pad[7]=r[30]&255|(r[31]&255)<<8};Kf.prototype.blocks=function(r,e,t){for(var f=this.fin?0:2048,n,s,c,b,y,B,p,q,A,Y,P,O,L,F,V,R,S,m,E,U=this.h[0],I=this.h[1],v=this.h[2],u=this.h[3],_=this.h[4],h=this.h[5],l=this.h[6],d=this.h[7],g=this.h[8],T=this.h[9],D=this.r[0],z=this.r[1],C=this.r[2],i=this.r[3],$=this.r[4],X=this.r[5],H=this.r[6],W=this.r[7],N=this.r[8],K=this.r[9];t>=16;)n=r[e+0]&255|(r[e+1]&255)<<8,U+=n&8191,s=r[e+2]&255|(r[e+3]&255)<<8,I+=(n>>>13|s<<3)&8191,c=r[e+4]&255|(r[e+5]&255)<<8,v+=(s>>>10|c<<6)&8191,b=r[e+6]&255|(r[e+7]&255)<<8,u+=(c>>>7|b<<9)&8191,y=r[e+8]&255|(r[e+9]&255)<<8,_+=(b>>>4|y<<12)&8191,h+=y>>>1&8191,B=r[e+10]&255|(r[e+11]&255)<<8,l+=(y>>>14|B<<2)&8191,p=r[e+12]&255|(r[e+13]&255)<<8,d+=(B>>>11|p<<5)&8191,q=r[e+14]&255|(r[e+15]&255)<<8,g+=(p>>>8|q<<8)&8191,T+=q>>>5|f,A=0,Y=A,Y+=U*D,Y+=I*(5*K),Y+=v*(5*N),Y+=u*(5*W),Y+=_*(5*H),A=Y>>>13,Y&=8191,Y+=h*(5*X),Y+=l*(5*$),Y+=d*(5*i),Y+=g*(5*C),Y+=T*(5*z),A+=Y>>>13,Y&=8191,P=A,P+=U*z,P+=I*D,P+=v*(5*K),P+=u*(5*N),P+=_*(5*W),A=P>>>13,P&=8191,P+=h*(5*H),P+=l*(5*X),P+=d*(5*$),P+=g*(5*i),P+=T*(5*C),A+=P>>>13,P&=8191,O=A,O+=U*C,O+=I*z,O+=v*D,O+=u*(5*K),O+=_*(5*N),A=O>>>13,O&=8191,O+=h*(5*W),O+=l*(5*H),O+=d*(5*X),O+=g*(5*$),O+=T*(5*i),A+=O>>>13,O&=8191,L=A,L+=U*i,L+=I*C,L+=v*z,L+=u*D,L+=_*(5*K),A=L>>>13,L&=8191,L+=h*(5*N),L+=l*(5*W),L+=d*(5*H),L+=g*(5*X),L+=T*(5*$),A+=L>>>13,L&=8191,F=A,F+=U*$,F+=I*i,F+=v*C,F+=u*z,F+=_*D,A=F>>>13,F&=8191,F+=h*(5*K),F+=l*(5*N),F+=d*(5*W),F+=g*(5*H),F+=T*(5*X),A+=F>>>13,F&=8191,V=A,V+=U*X,V+=I*$,V+=v*i,V+=u*C,V+=_*z,A=V>>>13,V&=8191,V+=h*D,V+=l*(5*K),V+=d*(5*N),V+=g*(5*W),V+=T*(5*H),A+=V>>>13,V&=8191,R=A,R+=U*H,R+=I*X,R+=v*$,R+=u*i,R+=_*C,A=R>>>13,R&=8191,R+=h*z,R+=l*D,R+=d*(5*K),R+=g*(5*N),R+=T*(5*W),A+=R>>>13,R&=8191,S=A,S+=U*W,S+=I*H,S+=v*X,S+=u*$,S+=_*i,A=S>>>13,S&=8191,S+=h*C,S+=l*z,S+=d*D,S+=g*(5*K),S+=T*(5*N),A+=S>>>13,S&=8191,m=A,m+=U*N,m+=I*W,m+=v*H,m+=u*X,m+=_*$,A=m>>>13,m&=8191,m+=h*i,m+=l*C,m+=d*z,m+=g*D,m+=T*(5*K),A+=m>>>13,m&=8191,E=A,E+=U*K,E+=I*N,E+=v*W,E+=u*H,E+=_*X,A=E>>>13,E&=8191,E+=h*$,E+=l*i,E+=d*C,E+=g*z,E+=T*D,A+=E>>>13,E&=8191,A=(A<<2)+A|0,A=A+Y|0,Y=A&8191,A=A>>>13,P+=A,U=Y,I=P,v=O,u=L,_=F,h=V,l=R,d=S,g=m,T=E,e+=16,t-=16;this.h[0]=U,this.h[1]=I,this.h[2]=v,this.h[3]=u,this.h[4]=_,this.h[5]=h,this.h[6]=l,this.h[7]=d,this.h[8]=g,this.h[9]=T},Kf.prototype.finish=function(r,e){var t=new Uint16Array(10),f,n,s,c;if(this.leftover){for(c=this.leftover,this.buffer[c++]=1;c<16;c++)this.buffer[c]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(f=this.h[1]>>>13,this.h[1]&=8191,c=2;c<10;c++)this.h[c]+=f,f=this.h[c]>>>13,this.h[c]&=8191;for(this.h[0]+=f*5,f=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=f,f=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=f,t[0]=this.h[0]+5,f=t[0]>>>13,t[0]&=8191,c=1;c<10;c++)t[c]=this.h[c]+f,f=t[c]>>>13,t[c]&=8191;for(t[9]-=8192,n=(f^1)-1,c=0;c<10;c++)t[c]&=n;for(n=~n,c=0;c<10;c++)this.h[c]=this.h[c]&n|t[c];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,s=this.h[0]+this.pad[0],this.h[0]=s&65535,c=1;c<8;c++)s=(this.h[c]+this.pad[c]|0)+(s>>>16)|0,this.h[c]=s&65535;r[e+0]=this.h[0]>>>0&255,r[e+1]=this.h[0]>>>8&255,r[e+2]=this.h[1]>>>0&255,r[e+3]=this.h[1]>>>8&255,r[e+4]=this.h[2]>>>0&255,r[e+5]=this.h[2]>>>8&255,r[e+6]=this.h[3]>>>0&255,r[e+7]=this.h[3]>>>8&255,r[e+8]=this.h[4]>>>0&255,r[e+9]=this.h[4]>>>8&255,r[e+10]=this.h[5]>>>0&255,r[e+11]=this.h[5]>>>8&255,r[e+12]=this.h[6]>>>0&255,r[e+13]=this.h[6]>>>8&255,r[e+14]=this.h[7]>>>0&255,r[e+15]=this.h[7]>>>8&255},Kf.prototype.update=function(r,e,t){var f,n;if(this.leftover){for(n=16-this.leftover,n>t&&(n=t),f=0;f<n;f++)this.buffer[this.leftover+f]=r[e+f];if(t-=n,e+=n,this.leftover+=n,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(t>=16&&(n=t-t%16,this.blocks(r,e,n),e+=n,t-=n),t){for(f=0;f<t;f++)this.buffer[this.leftover+f]=r[e+f];this.leftover+=t}};function cr(r,e,t,f,n,s){var c=new Kf(s);return c.update(t,f,n),c.finish(r,e),0}function Rr(r,e,t,f,n,s){var c=new Uint8Array(16);return cr(c,0,t,f,n,s),Tr(r,e,c,0)}function ur(r,e,t,f,n){var s;if(t<32)return-1;for(sr(r,0,e,0,t,f,n),cr(r,16,r,32,t-32,r),s=0;s<16;s++)r[s]=0;return 0}function _r(r,e,t,f,n){var s,c=new Uint8Array(32);if(t<32||(Fr(c,0,32,f,n),Rr(e,16,e,32,t-32,c)!==0))return-1;for(sr(r,0,e,0,t,f,n),s=0;s<32;s++)r[s]=0;return 0}function gf(r,e){var t;for(t=0;t<16;t++)r[t]=e[t]|0}function lr(r){var e,t,f=1;for(e=0;e<16;e++)t=r[e]+f+65535,f=Math.floor(t/65536),r[e]=t-f*65536;r[0]+=f-1+37*(f-1)}function Uf(r,e,t){for(var f,n=~(t-1),s=0;s<16;s++)f=n&(r[s]^e[s]),r[s]^=f,e[s]^=f}function If(r,e){var t,f,n,s=a(),c=a();for(t=0;t<16;t++)c[t]=e[t];for(lr(c),lr(c),lr(c),f=0;f<2;f++){for(s[0]=c[0]-65517,t=1;t<15;t++)s[t]=c[t]-65535-(s[t-1]>>16&1),s[t-1]&=65535;s[15]=c[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,Uf(c,s,1-n)}for(t=0;t<16;t++)r[2*t]=c[t]&255,r[2*t+1]=c[t]>>8}function Vr(r,e){var t=new Uint8Array(32),f=new Uint8Array(32);return If(t,r),If(f,e),xr(t,0,f,0)}function Lr(r){var e=new Uint8Array(32);return If(e,r),e[0]&1}function br(r,e){var t;for(t=0;t<16;t++)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function lf(r,e,t){for(var f=0;f<16;f++)r[f]=e[f]+t[f]}function bf(r,e,t){for(var f=0;f<16;f++)r[f]=e[f]-t[f]}function G(r,e,t){var f,n,s=0,c=0,b=0,y=0,B=0,p=0,q=0,A=0,Y=0,P=0,O=0,L=0,F=0,V=0,R=0,S=0,m=0,E=0,U=0,I=0,v=0,u=0,_=0,h=0,l=0,d=0,g=0,T=0,D=0,z=0,C=0,i=t[0],$=t[1],X=t[2],H=t[3],W=t[4],N=t[5],K=t[6],tf=t[7],Q=t[8],k=t[9],ff=t[10],rf=t[11],nf=t[12],of=t[13],af=t[14],xf=t[15];f=e[0],s+=f*i,c+=f*$,b+=f*X,y+=f*H,B+=f*W,p+=f*N,q+=f*K,A+=f*tf,Y+=f*Q,P+=f*k,O+=f*ff,L+=f*rf,F+=f*nf,V+=f*of,R+=f*af,S+=f*xf,f=e[1],c+=f*i,b+=f*$,y+=f*X,B+=f*H,p+=f*W,q+=f*N,A+=f*K,Y+=f*tf,P+=f*Q,O+=f*k,L+=f*ff,F+=f*rf,V+=f*nf,R+=f*of,S+=f*af,m+=f*xf,f=e[2],b+=f*i,y+=f*$,B+=f*X,p+=f*H,q+=f*W,A+=f*N,Y+=f*K,P+=f*tf,O+=f*Q,L+=f*k,F+=f*ff,V+=f*rf,R+=f*nf,S+=f*of,m+=f*af,E+=f*xf,f=e[3],y+=f*i,B+=f*$,p+=f*X,q+=f*H,A+=f*W,Y+=f*N,P+=f*K,O+=f*tf,L+=f*Q,F+=f*k,V+=f*ff,R+=f*rf,S+=f*nf,m+=f*of,E+=f*af,U+=f*xf,f=e[4],B+=f*i,p+=f*$,q+=f*X,A+=f*H,Y+=f*W,P+=f*N,O+=f*K,L+=f*tf,F+=f*Q,V+=f*k,R+=f*ff,S+=f*rf,m+=f*nf,E+=f*of,U+=f*af,I+=f*xf,f=e[5],p+=f*i,q+=f*$,A+=f*X,Y+=f*H,P+=f*W,O+=f*N,L+=f*K,F+=f*tf,V+=f*Q,R+=f*k,S+=f*ff,m+=f*rf,E+=f*nf,U+=f*of,I+=f*af,v+=f*xf,f=e[6],q+=f*i,A+=f*$,Y+=f*X,P+=f*H,O+=f*W,L+=f*N,F+=f*K,V+=f*tf,R+=f*Q,S+=f*k,m+=f*ff,E+=f*rf,U+=f*nf,I+=f*of,v+=f*af,u+=f*xf,f=e[7],A+=f*i,Y+=f*$,P+=f*X,O+=f*H,L+=f*W,F+=f*N,V+=f*K,R+=f*tf,S+=f*Q,m+=f*k,E+=f*ff,U+=f*rf,I+=f*nf,v+=f*of,u+=f*af,_+=f*xf,f=e[8],Y+=f*i,P+=f*$,O+=f*X,L+=f*H,F+=f*W,V+=f*N,R+=f*K,S+=f*tf,m+=f*Q,E+=f*k,U+=f*ff,I+=f*rf,v+=f*nf,u+=f*of,_+=f*af,h+=f*xf,f=e[9],P+=f*i,O+=f*$,L+=f*X,F+=f*H,V+=f*W,R+=f*N,S+=f*K,m+=f*tf,E+=f*Q,U+=f*k,I+=f*ff,v+=f*rf,u+=f*nf,_+=f*of,h+=f*af,l+=f*xf,f=e[10],O+=f*i,L+=f*$,F+=f*X,V+=f*H,R+=f*W,S+=f*N,m+=f*K,E+=f*tf,U+=f*Q,I+=f*k,v+=f*ff,u+=f*rf,_+=f*nf,h+=f*of,l+=f*af,d+=f*xf,f=e[11],L+=f*i,F+=f*$,V+=f*X,R+=f*H,S+=f*W,m+=f*N,E+=f*K,U+=f*tf,I+=f*Q,v+=f*k,u+=f*ff,_+=f*rf,h+=f*nf,l+=f*of,d+=f*af,g+=f*xf,f=e[12],F+=f*i,V+=f*$,R+=f*X,S+=f*H,m+=f*W,E+=f*N,U+=f*K,I+=f*tf,v+=f*Q,u+=f*k,_+=f*ff,h+=f*rf,l+=f*nf,d+=f*of,g+=f*af,T+=f*xf,f=e[13],V+=f*i,R+=f*$,S+=f*X,m+=f*H,E+=f*W,U+=f*N,I+=f*K,v+=f*tf,u+=f*Q,_+=f*k,h+=f*ff,l+=f*rf,d+=f*nf,g+=f*of,T+=f*af,D+=f*xf,f=e[14],R+=f*i,S+=f*$,m+=f*X,E+=f*H,U+=f*W,I+=f*N,v+=f*K,u+=f*tf,_+=f*Q,h+=f*k,l+=f*ff,d+=f*rf,g+=f*nf,T+=f*of,D+=f*af,z+=f*xf,f=e[15],S+=f*i,m+=f*$,E+=f*X,U+=f*H,I+=f*W,v+=f*N,u+=f*K,_+=f*tf,h+=f*Q,l+=f*k,d+=f*ff,g+=f*rf,T+=f*nf,D+=f*of,z+=f*af,C+=f*xf,s+=38*m,c+=38*E,b+=38*U,y+=38*I,B+=38*v,p+=38*u,q+=38*_,A+=38*h,Y+=38*l,P+=38*d,O+=38*g,L+=38*T,F+=38*D,V+=38*z,R+=38*C,n=1,f=s+n+65535,n=Math.floor(f/65536),s=f-n*65536,f=c+n+65535,n=Math.floor(f/65536),c=f-n*65536,f=b+n+65535,n=Math.floor(f/65536),b=f-n*65536,f=y+n+65535,n=Math.floor(f/65536),y=f-n*65536,f=B+n+65535,n=Math.floor(f/65536),B=f-n*65536,f=p+n+65535,n=Math.floor(f/65536),p=f-n*65536,f=q+n+65535,n=Math.floor(f/65536),q=f-n*65536,f=A+n+65535,n=Math.floor(f/65536),A=f-n*65536,f=Y+n+65535,n=Math.floor(f/65536),Y=f-n*65536,f=P+n+65535,n=Math.floor(f/65536),P=f-n*65536,f=O+n+65535,n=Math.floor(f/65536),O=f-n*65536,f=L+n+65535,n=Math.floor(f/65536),L=f-n*65536,f=F+n+65535,n=Math.floor(f/65536),F=f-n*65536,f=V+n+65535,n=Math.floor(f/65536),V=f-n*65536,f=R+n+65535,n=Math.floor(f/65536),R=f-n*65536,f=S+n+65535,n=Math.floor(f/65536),S=f-n*65536,s+=n-1+37*(n-1),n=1,f=s+n+65535,n=Math.floor(f/65536),s=f-n*65536,f=c+n+65535,n=Math.floor(f/65536),c=f-n*65536,f=b+n+65535,n=Math.floor(f/65536),b=f-n*65536,f=y+n+65535,n=Math.floor(f/65536),y=f-n*65536,f=B+n+65535,n=Math.floor(f/65536),B=f-n*65536,f=p+n+65535,n=Math.floor(f/65536),p=f-n*65536,f=q+n+65535,n=Math.floor(f/65536),q=f-n*65536,f=A+n+65535,n=Math.floor(f/65536),A=f-n*65536,f=Y+n+65535,n=Math.floor(f/65536),Y=f-n*65536,f=P+n+65535,n=Math.floor(f/65536),P=f-n*65536,f=O+n+65535,n=Math.floor(f/65536),O=f-n*65536,f=L+n+65535,n=Math.floor(f/65536),L=f-n*65536,f=F+n+65535,n=Math.floor(f/65536),F=f-n*65536,f=V+n+65535,n=Math.floor(f/65536),V=f-n*65536,f=R+n+65535,n=Math.floor(f/65536),R=f-n*65536,f=S+n+65535,n=Math.floor(f/65536),S=f-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=c,r[2]=b,r[3]=y,r[4]=B,r[5]=p,r[6]=q,r[7]=A,r[8]=Y,r[9]=P,r[10]=O,r[11]=L,r[12]=F,r[13]=V,r[14]=R,r[15]=S}function uf(r,e){G(r,e,e)}function Or(r,e){var t=a(),f;for(f=0;f<16;f++)t[f]=e[f];for(f=253;f>=0;f--)uf(t,t),f!==2&&f!==4&&G(t,t,e);for(f=0;f<16;f++)r[f]=t[f]}function Dr(r,e){var t=a(),f;for(f=0;f<16;f++)t[f]=e[f];for(f=250;f>=0;f--)uf(t,t),f!==1&&G(t,t,e);for(f=0;f<16;f++)r[f]=t[f]}function Zf(r,e,t){var f=new Uint8Array(32),n=new Float64Array(80),s,c,b=a(),y=a(),B=a(),p=a(),q=a(),A=a();for(c=0;c<31;c++)f[c]=e[c];for(f[31]=e[31]&127|64,f[0]&=248,br(n,t),c=0;c<16;c++)y[c]=n[c],p[c]=b[c]=B[c]=0;for(b[0]=p[0]=1,c=254;c>=0;--c)s=f[c>>>3]>>>(c&7)&1,Uf(b,y,s),Uf(B,p,s),lf(q,b,B),bf(b,b,B),lf(B,y,p),bf(y,y,p),uf(p,q),uf(A,b),G(b,B,b),G(B,y,q),lf(q,b,B),bf(b,b,B),uf(y,b),bf(B,p,A),G(b,B,sf),lf(b,b,p),G(B,B,b),G(b,p,A),G(p,y,n),uf(y,q),Uf(b,y,s),Uf(B,p,s);for(c=0;c<16;c++)n[c+16]=b[c],n[c+32]=B[c],n[c+48]=y[c],n[c+64]=p[c];var Y=n.subarray(32),P=n.subarray(16);return Or(Y,Y),G(P,P,Y),If(r,P),0}function qf(r,e){return Zf(r,e,Z)}function Cr(r,e){return w(e,32),qf(r,e)}function Xf(r,e,t){var f=new Uint8Array(32);return Zf(f,t,e),Nf(r,j,f,pf)}var zr=ur,bt=_r;function dt(r,e,t,f,n,s){var c=new Uint8Array(32);return Xf(c,n,s),zr(r,e,t,f,c)}function ht(r,e,t,f,n,s){var c=new Uint8Array(32);return Xf(c,n,s),bt(r,e,t,f,c)}var Wr=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function $r(r,e,t,f){for(var n=new Int32Array(16),s=new Int32Array(16),c,b,y,B,p,q,A,Y,P,O,L,F,V,R,S,m,E,U,I,v,u,_,h,l,d,g,T=r[0],D=r[1],z=r[2],C=r[3],i=r[4],$=r[5],X=r[6],H=r[7],W=e[0],N=e[1],K=e[2],tf=e[3],Q=e[4],k=e[5],ff=e[6],rf=e[7],nf=0;f>=128;){for(I=0;I<16;I++)v=8*I+nf,n[I]=t[v+0]<<24|t[v+1]<<16|t[v+2]<<8|t[v+3],s[I]=t[v+4]<<24|t[v+5]<<16|t[v+6]<<8|t[v+7];for(I=0;I<80;I++)if(c=T,b=D,y=z,B=C,p=i,q=$,A=X,Y=H,P=W,O=N,L=K,F=tf,V=Q,R=k,S=ff,m=rf,u=H,_=rf,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=(i>>>14|Q<<18)^(i>>>18|Q<<14)^(Q>>>9|i<<23),_=(Q>>>14|i<<18)^(Q>>>18|i<<14)^(i>>>9|Q<<23),h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,u=i&$^~i&X,_=Q&k^~Q&ff,h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,u=Wr[I*2],_=Wr[I*2+1],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,u=n[I%16],_=s[I%16],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,E=d&65535|g<<16,U=h&65535|l<<16,u=E,_=U,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=(T>>>28|W<<4)^(W>>>2|T<<30)^(W>>>7|T<<25),_=(W>>>28|T<<4)^(T>>>2|W<<30)^(T>>>7|W<<25),h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,u=T&D^T&z^D&z,_=W&N^W&K^N&K,h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,Y=d&65535|g<<16,m=h&65535|l<<16,u=B,_=F,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=E,_=U,h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,B=d&65535|g<<16,F=h&65535|l<<16,D=c,z=b,C=y,i=B,$=p,X=q,H=A,T=Y,N=P,K=O,tf=L,Q=F,k=V,ff=R,rf=S,W=m,I%16===15)for(v=0;v<16;v++)u=n[v],_=s[v],h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=n[(v+9)%16],_=s[(v+9)%16],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,E=n[(v+1)%16],U=s[(v+1)%16],u=(E>>>1|U<<31)^(E>>>8|U<<24)^E>>>7,_=(U>>>1|E<<31)^(U>>>8|E<<24)^(U>>>7|E<<25),h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,E=n[(v+14)%16],U=s[(v+14)%16],u=(E>>>19|U<<13)^(U>>>29|E<<3)^E>>>6,_=(U>>>19|E<<13)^(E>>>29|U<<3)^(U>>>6|E<<26),h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,n[v]=d&65535|g<<16,s[v]=h&65535|l<<16;u=T,_=W,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[0],_=e[0],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[0]=T=d&65535|g<<16,e[0]=W=h&65535|l<<16,u=D,_=N,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[1],_=e[1],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[1]=D=d&65535|g<<16,e[1]=N=h&65535|l<<16,u=z,_=K,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[2],_=e[2],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[2]=z=d&65535|g<<16,e[2]=K=h&65535|l<<16,u=C,_=tf,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[3],_=e[3],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[3]=C=d&65535|g<<16,e[3]=tf=h&65535|l<<16,u=i,_=Q,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[4],_=e[4],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[4]=i=d&65535|g<<16,e[4]=Q=h&65535|l<<16,u=$,_=k,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[5],_=e[5],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[5]=$=d&65535|g<<16,e[5]=k=h&65535|l<<16,u=X,_=ff,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[6],_=e[6],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[6]=X=d&65535|g<<16,e[6]=ff=h&65535|l<<16,u=H,_=rf,h=_&65535,l=_>>>16,d=u&65535,g=u>>>16,u=r[7],_=e[7],h+=_&65535,l+=_>>>16,d+=u&65535,g+=u>>>16,l+=h>>>16,d+=l>>>16,g+=d>>>16,r[7]=H=d&65535|g<<16,e[7]=rf=h&65535|l<<16,nf+=128,f-=128}return f}function Ef(r,e,t){var f=new Int32Array(8),n=new Int32Array(8),s=new Uint8Array(256),c,b=t;for(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,n[0]=4089235720,n[1]=2227873595,n[2]=4271175723,n[3]=1595750129,n[4]=2917565137,n[5]=725511199,n[6]=4215389547,n[7]=327033209,$r(f,n,e,t),t%=128,c=0;c<t;c++)s[c]=e[b-t+c];for(s[t]=128,t=256-128*(t<112?1:0),s[t-9]=0,$f(s,t-8,b/536870912|0,b<<3),$r(f,n,s,t),c=0;c<8;c++)$f(r,8*c,f[c],n[c]);return 0}function Hf(r,e){var t=a(),f=a(),n=a(),s=a(),c=a(),b=a(),y=a(),B=a(),p=a();bf(t,r[1],r[0]),bf(p,e[1],e[0]),G(t,t,p),lf(f,r[0],r[1]),lf(p,e[0],e[1]),G(f,f,p),G(n,r[3],e[3]),G(n,n,or),G(s,r[2],e[2]),lf(s,s,s),bf(c,f,t),bf(b,s,n),lf(y,s,n),lf(B,f,t),G(r[0],c,b),G(r[1],B,y),G(r[2],y,b),G(r[3],c,B)}function Gr(r,e,t){var f;for(f=0;f<4;f++)Uf(r[f],e[f],t)}function dr(r,e){var t=a(),f=a(),n=a();Or(n,e[2]),G(t,e[0],n),G(f,e[1],n),If(r,f),r[31]^=Lr(t)<<7}function hr(r,e,t){var f,n;for(gf(r[0],J),gf(r[1],ef),gf(r[2],ef),gf(r[3],J),n=255;n>=0;--n)f=t[n/8|0]>>(n&7)&1,Gr(r,e,f),Hf(e,r),Hf(r,r),Gr(r,e,f)}function Jf(r,e){var t=[a(),a(),a(),a()];gf(t[0],zf),gf(t[1],Wf),gf(t[2],ef),G(t[3],zf,Wf),hr(r,t,e)}function gr(r,e,t){var f=new Uint8Array(64),n=[a(),a(),a(),a()],s;for(t||w(e,32),Ef(f,e,32),f[0]&=248,f[31]&=127,f[31]|=64,Jf(n,f),dr(r,n),s=0;s<32;s++)e[s+32]=r[s];return 0}var Qf=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function wr(r,e){var t,f,n,s;for(f=63;f>=32;--f){for(t=0,n=f-32,s=f-12;n<s;++n)e[n]+=t-16*e[f]*Qf[n-(f-32)],t=Math.floor((e[n]+128)/256),e[n]-=t*256;e[n]+=t,e[f]=0}for(t=0,n=0;n<32;n++)e[n]+=t-(e[31]>>4)*Qf[n],t=e[n]>>8,e[n]&=255;for(n=0;n<32;n++)e[n]-=t*Qf[n];for(f=0;f<32;f++)e[f+1]+=e[f]>>8,r[f]=e[f]&255}function yr(r){var e=new Float64Array(64),t;for(t=0;t<64;t++)e[t]=r[t];for(t=0;t<64;t++)r[t]=0;wr(r,e)}function Nr(r,e,t,f){var n=new Uint8Array(64),s=new Uint8Array(64),c=new Uint8Array(64),b,y,B=new Float64Array(64),p=[a(),a(),a(),a()];Ef(n,f,32),n[0]&=248,n[31]&=127,n[31]|=64;var q=t+64;for(b=0;b<t;b++)r[64+b]=e[b];for(b=0;b<32;b++)r[32+b]=n[32+b];for(Ef(c,r.subarray(32),t+32),yr(c),Jf(p,c),dr(r,p),b=32;b<64;b++)r[b]=f[b];for(Ef(s,r,t+64),yr(s),b=0;b<64;b++)B[b]=0;for(b=0;b<32;b++)B[b]=c[b];for(b=0;b<32;b++)for(y=0;y<32;y++)B[b+y]+=s[b]*n[y];return wr(r.subarray(32),B),q}function gt(r,e){var t=a(),f=a(),n=a(),s=a(),c=a(),b=a(),y=a();return gf(r[2],ef),br(r[1],e),uf(n,r[1]),G(s,n,Cf),bf(n,n,r[2]),lf(s,r[2],s),uf(c,s),uf(b,c),G(y,b,c),G(t,y,n),G(t,t,s),Dr(t,t),G(t,t,n),G(t,t,s),G(t,t,s),G(r[0],t,s),uf(f,r[0]),G(f,f,s),Vr(f,n)&&G(r[0],r[0],ir),uf(f,r[0]),G(f,f,s),Vr(f,n)?-1:(Lr(r[0])===e[31]>>7&&bf(r[0],J,r[0]),G(r[3],r[0],r[1]),0)}function vr(r,e,t,f){var n,s=new Uint8Array(32),c=new Uint8Array(64),b=[a(),a(),a(),a()],y=[a(),a(),a(),a()];if(t<64||gt(y,f))return-1;for(n=0;n<t;n++)r[n]=e[n];for(n=0;n<32;n++)r[n+32]=f[n];if(Ef(c,r,t),yr(c),hr(b,y,c),Jf(y,e.subarray(32)),Hf(b,y),dr(s,b),t-=64,xr(e,0,s,0)){for(n=0;n<t;n++)r[n]=0;return-1}for(n=0;n<t;n++)r[n]=e[n+64];return t}var pr=32,kf=24,Pf=32,jf=16,Ff=32,fr=32,Rf=32,Vf=32,Er=32,Kr=kf,wt=Pf,yt=jf,wf=64,Af=32,Bf=64,Ar=32,Sr=64;o.lowlevel={crypto_core_hsalsa20:Nf,crypto_stream_xor:sr,crypto_stream:Fr,crypto_stream_salsa20_xor:Yr,crypto_stream_salsa20:Pr,crypto_onetimeauth:cr,crypto_onetimeauth_verify:Rr,crypto_verify_16:Tr,crypto_verify_32:xr,crypto_secretbox:ur,crypto_secretbox_open:_r,crypto_scalarmult:Zf,crypto_scalarmult_base:qf,crypto_box_beforenm:Xf,crypto_box_afternm:zr,crypto_box:dt,crypto_box_open:ht,crypto_box_keypair:Cr,crypto_hash:Ef,crypto_sign:Nr,crypto_sign_keypair:gr,crypto_sign_open:vr,crypto_secretbox_KEYBYTES:pr,crypto_secretbox_NONCEBYTES:kf,crypto_secretbox_ZEROBYTES:Pf,crypto_secretbox_BOXZEROBYTES:jf,crypto_scalarmult_BYTES:Ff,crypto_scalarmult_SCALARBYTES:fr,crypto_box_PUBLICKEYBYTES:Rf,crypto_box_SECRETKEYBYTES:Vf,crypto_box_BEFORENMBYTES:Er,crypto_box_NONCEBYTES:Kr,crypto_box_ZEROBYTES:wt,crypto_box_BOXZEROBYTES:yt,crypto_sign_BYTES:wf,crypto_sign_PUBLICKEYBYTES:Af,crypto_sign_SECRETKEYBYTES:Bf,crypto_sign_SEEDBYTES:Ar,crypto_hash_BYTES:Sr,gf:a,D:Cf,L:Qf,pack25519:If,unpack25519:br,M:G,A:lf,S:uf,Z:bf,pow2523:Dr,add:Hf,set25519:gf,modL:wr,scalarmult:hr,scalarbase:Jf};function Zr(r,e){if(r.length!==pr)throw new Error("bad key size");if(e.length!==kf)throw new Error("bad nonce size")}function vt(r,e){if(r.length!==Rf)throw new Error("bad public key size");if(e.length!==Vf)throw new Error("bad secret key size")}function cf(){for(var r=0;r<arguments.length;r++)if(!(arguments[r]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function qr(r){for(var e=0;e<r.length;e++)r[e]=0}o.randomBytes=function(r){var e=new Uint8Array(r);return w(e,r),e},o.secretbox=function(r,e,t){cf(r,e,t),Zr(t,e);for(var f=new Uint8Array(Pf+r.length),n=new Uint8Array(f.length),s=0;s<r.length;s++)f[s+Pf]=r[s];return ur(n,f,f.length,e,t),n.subarray(jf)},o.secretbox.open=function(r,e,t){cf(r,e,t),Zr(t,e);for(var f=new Uint8Array(jf+r.length),n=new Uint8Array(f.length),s=0;s<r.length;s++)f[s+jf]=r[s];return f.length<32||_r(n,f,f.length,e,t)!==0?null:n.subarray(Pf)},o.secretbox.keyLength=pr,o.secretbox.nonceLength=kf,o.secretbox.overheadLength=jf,o.scalarMult=function(r,e){if(cf(r,e),r.length!==fr)throw new Error("bad n size");if(e.length!==Ff)throw new Error("bad p size");var t=new Uint8Array(Ff);return Zf(t,r,e),t},o.scalarMult.base=function(r){if(cf(r),r.length!==fr)throw new Error("bad n size");var e=new Uint8Array(Ff);return qf(e,r),e},o.scalarMult.scalarLength=fr,o.scalarMult.groupElementLength=Ff,o.box=function(r,e,t,f){var n=o.box.before(t,f);return o.secretbox(r,e,n)},o.box.before=function(r,e){cf(r,e),vt(r,e);var t=new Uint8Array(Er);return Xf(t,r,e),t},o.box.after=o.secretbox,o.box.open=function(r,e,t,f){var n=o.box.before(t,f);return o.secretbox.open(r,e,n)},o.box.open.after=o.secretbox.open,o.box.keyPair=function(){var r=new Uint8Array(Rf),e=new Uint8Array(Vf);return Cr(r,e),{publicKey:r,secretKey:e}},o.box.keyPair.fromSecretKey=function(r){if(cf(r),r.length!==Vf)throw new Error("bad secret key size");var e=new Uint8Array(Rf);return qf(e,r),{publicKey:e,secretKey:new Uint8Array(r)}},o.box.publicKeyLength=Rf,o.box.secretKeyLength=Vf,o.box.sharedKeyLength=Er,o.box.nonceLength=Kr,o.box.overheadLength=o.secretbox.overheadLength,o.sign=function(r,e){if(cf(r,e),e.length!==Bf)throw new Error("bad secret key size");var t=new Uint8Array(wf+r.length);return Nr(t,r,r.length,e),t},o.sign.open=function(r,e){if(cf(r,e),e.length!==Af)throw new Error("bad public key size");var t=new Uint8Array(r.length),f=vr(t,r,r.length,e);if(f<0)return null;for(var n=new Uint8Array(f),s=0;s<n.length;s++)n[s]=t[s];return n},o.sign.detached=function(r,e){for(var t=o.sign(r,e),f=new Uint8Array(wf),n=0;n<f.length;n++)f[n]=t[n];return f},o.sign.detached.verify=function(r,e,t){if(cf(r,e,t),e.length!==wf)throw new Error("bad signature size");if(t.length!==Af)throw new Error("bad public key size");var f=new Uint8Array(wf+r.length),n=new Uint8Array(wf+r.length),s;for(s=0;s<wf;s++)f[s]=e[s];for(s=0;s<r.length;s++)f[s+wf]=r[s];return vr(n,f,f.length,t)>=0},o.sign.keyPair=function(){var r=new Uint8Array(Af),e=new Uint8Array(Bf);return gr(r,e),{publicKey:r,secretKey:e}},o.sign.keyPair.fromSecretKey=function(r){if(cf(r),r.length!==Bf)throw new Error("bad secret key size");for(var e=new Uint8Array(Af),t=0;t<e.length;t++)e[t]=r[32+t];return{publicKey:e,secretKey:new Uint8Array(r)}},o.sign.keyPair.fromSeed=function(r){if(cf(r),r.length!==Ar)throw new Error("bad seed size");for(var e=new Uint8Array(Af),t=new Uint8Array(Bf),f=0;f<32;f++)t[f]=r[f];return gr(e,t,!0),{publicKey:e,secretKey:t}},o.sign.publicKeyLength=Af,o.sign.secretKeyLength=Bf,o.sign.seedLength=Ar,o.sign.signatureLength=wf,o.hash=function(r){cf(r);var e=new Uint8Array(Sr);return Ef(e,r,r.length),e},o.hash.hashLength=Sr,o.verify=function(r,e){return cf(r,e),r.length===0||e.length===0||r.length!==e.length?!1:ar(r,0,e,0,r.length)===0},o.setPRNG=function(r){w=r},function(){var r=typeof self<"u"?self.crypto||self.msCrypto:null;if(r&&r.getRandomValues){var e=65536;o.setPRNG(function(t,f){var n,s=new Uint8Array(f);for(n=0;n<f;n+=e)r.getRandomValues(s.subarray(n,n+Math.min(f-n,e)));for(n=0;n<f;n++)t[n]=s[n];qr(s)})}else typeof Jr<"u"&&(r=ft,r&&r.randomBytes&&o.setPRNG(function(t,f){var n,s=r.randomBytes(f);for(n=0;n<f;n++)t[n]=s[n];qr(s)}))}()})(x.exports?x.exports:self.nacl=self.nacl||{})})(Ur);var rt=Ur.exports,tt=Xr(rt);let M;function Sf(x){const o=M.__externref_table_alloc();return M.__wbindgen_export_2.set(o,x),o}function mf(x,o){try{return x.apply(this,o)}catch(a){const w=Sf(a);M.__wbindgen_exn_store(w)}}const Ir=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Ir.decode();let Mf=null;function Lf(){return(Mf===null||Mf.byteLength===0)&&(Mf=new Uint8Array(M.memory.buffer)),Mf}function df(x,o){return x=x>>>0,Ir.decode(Lf().subarray(x,x+o))}function Tf(x){return x==null}function rr(x){const o=typeof x;if(o=="number"||o=="boolean"||x==null)return`${x}`;if(o=="string")return`"${x}"`;if(o=="symbol"){const j=x.description;return j==null?"Symbol":`Symbol(${j})`}if(o=="function"){const j=x.name;return typeof j=="string"&&j.length>0?`Function(${j})`:"Function"}if(Array.isArray(x)){const j=x.length;let Z="[";j>0&&(Z+=rr(x[0]));for(let J=1;J<j;J++)Z+=", "+rr(x[J]);return Z+="]",Z}const a=/\[object ([^\]]+)\]/.exec(toString.call(x));let w;if(a&&a.length>1)w=a[1];else return toString.call(x);if(w=="Object")try{return"Object("+JSON.stringify(x)+")"}catch{return"Object"}return x instanceof Error?`${x.name}: ${x.message}
${x.stack}`:w}let _f=0;const Of=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},et=typeof Of.encodeInto=="function"?function(x,o){return Of.encodeInto(x,o)}:function(x,o){const a=Of.encode(x);return o.set(a),{read:x.length,written:a.length}};function hf(x,o,a){if(a===void 0){const ef=Of.encode(x),sf=o(ef.length,1)>>>0;return Lf().subarray(sf,sf+ef.length).set(ef),_f=ef.length,sf}let w=x.length,j=o(w,1)>>>0;const Z=Lf();let J=0;for(;J<w;J++){const ef=x.charCodeAt(J);if(ef>127)break;Z[j+J]=ef}if(J!==w){J!==0&&(x=x.slice(J)),j=a(j,w,w=J+x.length*3,1)>>>0;const ef=Lf().subarray(j+J,j+w),sf=et(x,ef);J+=sf.written,j=a(j,w,J,1)>>>0}return _f=J,j}let yf=null;function jr(){return(yf===null||yf.buffer.detached===!0||yf.buffer.detached===void 0&&yf.buffer!==M.memory.buffer)&&(yf=new DataView(M.memory.buffer)),yf}function Yf(x){const o=M.__wbindgen_export_2.get(x);return M.__externref_table_dealloc(x),o}function nt(x,o){if(!(x instanceof o))throw new Error(`expected instance of ${o.name}`)}const tr=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(x=>M.__wbg_vdfcomputer_free(x>>>0,1));class Df{static __wrap(o){o=o>>>0;const a=Object.create(Df.prototype);return a.__wbg_ptr=o,tr.register(a,a.__wbg_ptr,a),a}__destroy_into_raw(){const o=this.__wbg_ptr;return this.__wbg_ptr=0,tr.unregister(this),o}free(){const o=this.__destroy_into_raw();M.__wbg_vdfcomputer_free(o,0)}constructor(){const o=M.vdfcomputer_new();return this.__wbg_ptr=o>>>0,tr.register(this,this.__wbg_ptr,this),this}static with_modulus(o){const a=hf(o,M.__wbindgen_malloc,M.__wbindgen_realloc),w=_f,j=M.vdfcomputer_with_modulus(a,w);if(j[2])throw Yf(j[1]);return Df.__wrap(j[0])}compute_proof(o,a,w){const j=hf(o,M.__wbindgen_malloc,M.__wbindgen_realloc),Z=_f,J=M.vdfcomputer_compute_proof(this.__wbg_ptr,j,Z,a,Tf(w)?0:Sf(w));if(J[2])throw Yf(J[1]);return vf.__wrap(J[0])}verify_proof(o,a){const w=hf(o,M.__wbindgen_malloc,M.__wbindgen_realloc),j=_f;nt(a,vf);const Z=M.vdfcomputer_verify_proof(this.__wbg_ptr,w,j,a.__wbg_ptr);if(Z[2])throw Yf(Z[1]);return Z[0]!==0}estimate_iterations_for_seconds(o){const a=M.vdfcomputer_estimate_iterations_for_seconds(this.__wbg_ptr,o);return BigInt.asUintN(64,a)}}const er=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(x=>M.__wbg_vdfproof_free(x>>>0,1));class vf{static __wrap(o){o=o>>>0;const a=Object.create(vf.prototype);return a.__wbg_ptr=o,er.register(a,a.__wbg_ptr,a),a}__destroy_into_raw(){const o=this.__wbg_ptr;return this.__wbg_ptr=0,er.unregister(this),o}free(){const o=this.__destroy_into_raw();M.__wbg_vdfproof_free(o,0)}constructor(o,a,w,j,Z){const J=hf(o,M.__wbindgen_malloc,M.__wbindgen_realloc),ef=_f,sf=hf(a,M.__wbindgen_malloc,M.__wbindgen_realloc),Cf=_f,or=hf(w,M.__wbindgen_malloc,M.__wbindgen_realloc),zf=_f,Wf=hf(j,M.__wbindgen_malloc,M.__wbindgen_realloc),ir=_f,$f=M.vdfproof_new(J,ef,sf,Cf,or,zf,Wf,ir,Z);return this.__wbg_ptr=$f>>>0,er.register(this,this.__wbg_ptr,this),this}get y(){let o,a;try{const w=M.vdfproof_y(this.__wbg_ptr);return o=w[0],a=w[1],df(w[0],w[1])}finally{M.__wbindgen_free(o,a,1)}}get pi(){let o,a;try{const w=M.vdfproof_pi(this.__wbg_ptr);return o=w[0],a=w[1],df(w[0],w[1])}finally{M.__wbindgen_free(o,a,1)}}get l(){let o,a;try{const w=M.vdfproof_l(this.__wbg_ptr);return o=w[0],a=w[1],df(w[0],w[1])}finally{M.__wbindgen_free(o,a,1)}}get r(){let o,a;try{const w=M.vdfproof_r(this.__wbg_ptr);return o=w[0],a=w[1],df(w[0],w[1])}finally{M.__wbindgen_free(o,a,1)}}get iterations(){const o=M.vdfproof_iterations(this.__wbg_ptr);return BigInt.asUintN(64,o)}to_json(){let o,a;try{const Z=M.vdfproof_to_json(this.__wbg_ptr);var w=Z[0],j=Z[1];if(Z[3])throw w=0,j=0,Yf(Z[2]);return o=w,a=j,df(w,j)}finally{M.__wbindgen_free(o,a,1)}}static from_json(o){const a=hf(o,M.__wbindgen_malloc,M.__wbindgen_realloc),w=_f,j=M.vdfproof_from_json(a,w);if(j[2])throw Yf(j[1]);return vf.__wrap(j[0])}}async function ot(x,o){if(typeof Response=="function"&&x instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(x,o)}catch(w){if(x.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",w);else throw w}const a=await x.arrayBuffer();return await WebAssembly.instantiate(a,o)}else{const a=await WebAssembly.instantiate(x,o);return a instanceof WebAssembly.Instance?{instance:a,module:x}:a}}function it(){const x={};return x.wbg={},x.wbg.__wbg_buffer_609cc3eee51ed158=function(o){return o.buffer},x.wbg.__wbg_call_672a4d21634d4a24=function(){return mf(function(o,a){return o.call(a)},arguments)},x.wbg.__wbg_call_7cccdd69e0791ae2=function(){return mf(function(o,a,w){return o.call(a,w)},arguments)},x.wbg.__wbg_crypto_574e78ad8b13b65f=function(o){return o.crypto},x.wbg.__wbg_getRandomValues_b8f5dbd5f3995a9e=function(){return mf(function(o,a){o.getRandomValues(a)},arguments)},x.wbg.__wbg_log_5b9c4377e97c70b5=function(o,a){console.log(df(o,a))},x.wbg.__wbg_msCrypto_a61aeb35a24c1329=function(o){return o.msCrypto},x.wbg.__wbg_new_a12002a7f91c75be=function(o){return new Uint8Array(o)},x.wbg.__wbg_newnoargs_105ed471475aaf50=function(o,a){return new Function(df(o,a))},x.wbg.__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a=function(o,a,w){return new Uint8Array(o,a>>>0,w>>>0)},x.wbg.__wbg_newwithlength_a381634e90c276d4=function(o){return new Uint8Array(o>>>0)},x.wbg.__wbg_node_905d3e251edff8a2=function(o){return o.node},x.wbg.__wbg_now_807e54c39636c349=function(){return Date.now()},x.wbg.__wbg_process_dc0fbacc7c1c06f7=function(o){return o.process},x.wbg.__wbg_randomFillSync_ac0988aba3254290=function(){return mf(function(o,a){o.randomFillSync(a)},arguments)},x.wbg.__wbg_require_60cc747a6bc5215a=function(){return mf(function(){return module.require},arguments)},x.wbg.__wbg_set_65595bdd868b3009=function(o,a,w){o.set(a,w>>>0)},x.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){const o=typeof global>"u"?null:global;return Tf(o)?0:Sf(o)},x.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){const o=typeof globalThis>"u"?null:globalThis;return Tf(o)?0:Sf(o)},x.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){const o=typeof self>"u"?null:self;return Tf(o)?0:Sf(o)},x.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){const o=typeof window>"u"?null:window;return Tf(o)?0:Sf(o)},x.wbg.__wbg_subarray_aa9065fa9dc5df96=function(o,a,w){return o.subarray(a>>>0,w>>>0)},x.wbg.__wbg_versions_c01dfd4722a88165=function(o){return o.versions},x.wbg.__wbg_warn_1e5be50445417c8a=function(o,a){console.warn(df(o,a))},x.wbg.__wbindgen_debug_string=function(o,a){const w=rr(a),j=hf(w,M.__wbindgen_malloc,M.__wbindgen_realloc),Z=_f;jr().setInt32(o+4*1,Z,!0),jr().setInt32(o+4*0,j,!0)},x.wbg.__wbindgen_init_externref_table=function(){const o=M.__wbindgen_export_2,a=o.grow(4);o.set(0,void 0),o.set(a+0,void 0),o.set(a+1,null),o.set(a+2,!0),o.set(a+3,!1)},x.wbg.__wbindgen_is_function=function(o){return typeof o=="function"},x.wbg.__wbindgen_is_object=function(o){const a=o;return typeof a=="object"&&a!==null},x.wbg.__wbindgen_is_string=function(o){return typeof o=="string"},x.wbg.__wbindgen_is_undefined=function(o){return o===void 0},x.wbg.__wbindgen_memory=function(){return M.memory},x.wbg.__wbindgen_number_new=function(o){return o},x.wbg.__wbindgen_string_new=function(o,a){return df(o,a)},x.wbg.__wbindgen_throw=function(o,a){throw new Error(df(o,a))},x}function at(x,o){return M=x.exports,Br.__wbindgen_wasm_module=o,yf=null,Mf=null,M.__wbindgen_start(),M}async function Br(x){if(M!==void 0)return M;typeof x<"u"&&(Object.getPrototypeOf(x)===Object.prototype?{module_or_path:x}=x:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof x>"u"&&(x=new URL("/assets/vdf_wasm_bg-n_nNcBiV.wasm",self.location.href));const o=it();(typeof x=="string"||typeof Request=="function"&&x instanceof Request||typeof URL=="function"&&x instanceof URL)&&(x=fetch(x));const{instance:a,module:w}=await ot(await x,o);return at(a,w)}let nr=null,mr=!1;async function xt(){mr||(await Br(new URL("/assets/vdf_wasm_bg-n_nNcBiV.wasm",self.location.href)),nr=new Df,mr=!0,console.log("[Worker] WASM VDF initialized"))}function st(x){let o="";const a=new Uint8Array(Object.values(x)),w=a.byteLength;for(let j=0;j<w;j++)o+=String.fromCharCode(a[j]);return btoa(o)}function ct(x){if(console.log(`[SIG_VERIFY] --- Starting verification for post ${x.id} ---`),console.log("[SIG_VERIFY] Post fields:",Object.keys(x)),!x.signature||!x.authorPublicKey)return console.error(`[SIG_VERIFY] ❌ FAILED: Post ${x.id} is missing signature or public key.`),!1;console.log("[SIG_VERIFY] Post has signature and public key. Proceeding...");try{const o=new Uint8Array(Object.values(x.authorPublicKey)),a=new Uint8Array(Object.values(x.signature));console.log("[SIG_VERIFY] Correctly handled keys and signature as byte arrays."),console.log(`[SIG_VERIFY]   > Public Key length: ${o.length} bytes`),console.log(`[SIG_VERIFY]   > Signature length: ${a.length} bytes`);const w=st(x.authorPublicKey),j={id:x.id,content:x.content,timestamp:x.timestamp,parentId:x.parentId,imageHash:x.imageHash,authorPublicKey:w,vdfInput:x.vdfInput,vdfProof:x.vdfProof?{y:x.vdfProof.y,pi:x.vdfProof.pi,l:x.vdfProof.l,r:x.vdfProof.r,iterations:x.vdfProof.iterations?x.vdfProof.iterations.toString():null}:null};console.log("[SIG_VERIFY] Reconstructed signableData object:",j);const Z=JSON.stringify(j);console.log("[SIG_VERIFY] Stringified data to verify:",Z);const J=new TextEncoder().encode(Z);console.log("[SIG_VERIFY] Calling nacl.sign.open...");const ef=tt.sign.open(a,o);if(ef===null)return console.error("[SIG_VERIFY] ❌ FAILED: nacl.sign.open returned null. The signature is cryptographically invalid for the given public key and message."),!1;console.log("[SIG_VERIFY] ✅ nacl.sign.open succeeded. Signature is valid for the public key.");const sf=new TextDecoder().decode(ef);return console.log("[SIG_VERIFY] Decoded message from signature:",sf),sf!==Z?(console.error("[SIG_VERIFY] ❌ FAILED: Message content mismatch after verification!"),console.error(`[SIG_VERIFY]   > Expected: ${Z}`),console.error(`[SIG_VERIFY]   > Got:      ${sf}`),!1):(console.log(`[SIG_VERIFY] ✅ SUCCESS: Message content matches. Signature for post ${x.id} is fully verified.`),!0)}catch(o){return console.error(`[SIG_VERIFY] ❌ FAILED: An unexpected error occurred during verification for post ${x.id}:`,o),!1}}self.addEventListener("message",async function(x){const{type:o,data:a,id:w}=x.data;try{switch(await xt(),o){case"verify_batch":const j=await ut(a.posts);self.postMessage({type:"batch_complete",id:w,results:j});break;case"verify_single":const Z=await Mr(a.post);self.postMessage({type:"single_complete",id:w,result:Z});break}}catch(j){self.postMessage({type:"error",id:w,error:String(j)})}});async function ut(x){const o=[];for(const a of x){const w=await Mr(a);o.push(w),o.length%10===0&&self.postMessage({type:"progress",completed:o.length,total:x.length})}return o}async function Mr(x){const o={id:x.id,valid:!1,errors:[]};console.log(`[Worker] Starting verification for post ${x.id}`);try{if(!x.authorVdfProof||typeof x.authorVdfProof!="object"||!x.authorVdfProof.y)return console.log("[Worker] Author VDF proof missing or malformed:",x.authorVdfProof),o.errors.push("Missing or malformed author VDF proof"),o;console.log("[Worker] Verifying author VDF proof...");const a=new vf(x.authorVdfProof.y,x.authorVdfProof.pi,x.authorVdfProof.l,x.authorVdfProof.r,BigInt(x.authorVdfProof.iterations)),w=await nr.verify_proof(x.authorVdfInput,a);if(console.log(`[Worker] Author VDF verification result: ${w}`),w||o.errors.push("Invalid author VDF proof"),x.vdfProof)if(typeof x.vdfProof!="object"||!x.vdfProof.y)console.log("[Worker] Post VDF proof malformed:",x.vdfProof),o.errors.push("Malformed post VDF proof");else{console.log("[Worker] Verifying post VDF proof...");const Z=new vf(x.vdfProof.y,x.vdfProof.pi,x.vdfProof.l,x.vdfProof.r,BigInt(x.vdfProof.iterations)),J=await nr.verify_proof(x.vdfInput,Z);console.log(`[Worker] Post VDF verification result: ${J}`),J||o.errors.push("Invalid post VDF proof")}console.log("[Worker] Verifying signature...");const j=ct(x);console.log(`[Worker] Signature verification result: ${j}`),j||o.errors.push("Invalid signature"),o.errors.length===0?(o.valid=!0,console.log(`[Worker] Post ${x.id} verification SUCCESS`)):console.log(`[Worker] Post ${x.id} verification FAILED. Errors:`,o.errors)}catch(a){console.error(`[Worker] Verification error for post ${x.id}:`,a),o.errors.push(a.message)}return o}})();
